{"version":3,"sources":["../../src/datasource-zabbix/migrations.js"],"names":[],"mappings":";;;;AAmCA,WAAS,cAAT,CAAwB,GAAxB,EAA6B;AAC3B,QAAI,GAAJ,EAAS;AACP,aAAO,MAAM,GAAN,GAAY,GAAZ,CADA;KAAT,MAEO;AACL,aAAO,MAAP,CADK;KAFP;GADF;;;;;;;;;AA9BO,eAAS,gBAAT,CAA0B,MAA1B,EAAkC;AACvC,YAAI,CAAC,OAAO,IAAP,IAAe,OAAO,IAAP,KAAgB,CAAhB,IAAqB,OAAO,IAAP,KAAgB,CAAhB,EAAmB;AAC1D,cAAI,CAAC,OAAO,UAAP,IAAqB,OAAO,UAAP,IAAqB,OAAO,kBAAP,IAC1C,OAAO,IAAP,IAAe,OAAO,IAAP,CAAY,IAAZ,CADhB,IAEC,OAAO,IAAP,CAAY,MAAZ,KAAuB,SAAvB,IAAoC,OAAO,IAAP,CAAY,MAAZ,KAAuB,SAAvB,EAAmC;AAC1E,mBAAO,IAAP,CAD0E;WAF5E,MAIO;AACL,mBAAO,KAAP,CADK;WAJP;SADF,MAQO;AACL,iBAAO,KAAP,CADK;SARP;OADK;;;;AAcA,eAAS,sBAAT,CAAgC,MAAhC,EAAwC;AAC7C,eAAO,KAAP,CAAa,MAAb,GAAsB,OAAO,KAAP,CAAa,IAAb,KAAsB,GAAtB,GAA4B,MAA5B,GAAqC,OAAO,KAAP,CAAa,IAAb,CADd;AAE7C,eAAO,IAAP,CAAY,MAAZ,GAAqB,OAAO,IAAP,CAAY,IAAZ,KAAqB,GAArB,GAA2B,eAAe,OAAO,UAAP,CAA1C,GAA+D,OAAO,IAAP,CAAY,IAAZ,CAFvC;AAG7C,eAAO,WAAP,CAAmB,MAAnB,GAA4B,OAAO,WAAP,CAAmB,IAAnB,KAA4B,GAA5B,GAAkC,EAAlC,GAAuC,OAAO,WAAP,CAAmB,IAAnB,CAHtB;AAI7C,eAAO,IAAP,CAAY,MAAZ,GAAqB,OAAO,IAAP,CAAY,IAAZ,KAAqB,KAArB,GAA6B,eAAe,OAAO,UAAP,CAA5C,GAAiE,OAAO,IAAP,CAAY,IAAZ,CAJzC;AAK7C,eAAO,MAAP,CAL6C;OAAxC;;;;AAQA,eAAS,OAAT,CAAiB,MAAjB,EAAyB;AAC9B,YAAI,iBAAiB,MAAjB,CAAJ,EAA8B;AAC5B,iBAAO,uBAAuB,MAAvB,CAAP,CAD4B;SAA9B,MAEO;AACL,iBAAO,MAAP,CADK;SAFP;OADK","file":"migrations.js","sourcesContent":["/**\n * Query format migration.\n * This module can detect query format version and make migration.\n */\n\nexport function isGrafana2target(target) {\n  if (!target.mode || target.mode === 0 || target.mode === 2) {\n    if ((target.hostFilter || target.itemFilter || target.downsampleFunction ||\n        (target.host && target.host.host)) &&\n        (target.item.filter === undefined && target.host.filter === undefined)) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nexport function migrateFrom2To3version(target) {\n  target.group.filter = target.group.name === \"*\" ? \"/.*/\" : target.group.name;\n  target.host.filter = target.host.name === \"*\" ? convertToRegex(target.hostFilter) : target.host.name;\n  target.application.filter = target.application.name === \"*\" ? \"\" : target.application.name;\n  target.item.filter = target.item.name === \"All\" ? convertToRegex(target.itemFilter) : target.item.name;\n  return target;\n}\n\nexport function migrate(target) {\n  if (isGrafana2target(target)) {\n    return migrateFrom2To3version(target);\n  } else {\n    return target;\n  }\n}\n\nfunction convertToRegex(str) {\n  if (str) {\n    return '/' + str + '/';\n  } else {\n    return '/.*/';\n  }\n}\n"]}